!function(r){function n(r){return r}function t(r,n,t){for(var e=0,i=n.length,o=t?JSON.parse(JSON.stringify(r)):Array(i);i>e;++e)o[e]=r[n[e]];return o}function e(r){function n(n,t,e,i){for(;i>e;){var o=e+i>>>1;r(n[o])<t?e=o+1:i=o}return e}function t(n,t,e,i){for(;i>e;){var o=e+i>>>1;t<r(n[o])?i=o:e=o+1}return e}return t.right=t,t.left=n,t}function o(r){function n(r,n,t){for(var i=t-n,o=(i>>>1)+1;--o>0;)e(r,o,i,n);return r}function t(r,n,t){for(var i,o=t-n;--o>0;)i=r[n],r[n]=r[n+o],r[n+o]=i,e(r,1,o,n);return r}function e(n,t,e,i){for(var o,u=n[--i+t],f=r(u);(o=t<<1)<=e&&(e>o&&r(n[i+o])>r(n[i+o+1])&&o++,!(f<=r(n[i+o])));)n[i+t]=n[i+o],t=o;n[i+t]=u}return n.sort=t,n}function u(r){function n(n,e,i,o){var u,f,a,l,s=Array(o=Math.min(i-e,o));for(f=0;o>f;++f)s[f]=n[e++];if(t(s,0,o),i>e){u=r(s[0]);do(a=r(l=n[e])>u)&&(s[0]=l,u=r(t(s,0,o)[0]));while(++e<i)}return s}var t=o(r);return n}function f(r){function n(n,t,e){for(var i=t+1;e>i;++i){for(var o=i,u=n[i],f=r(u);o>t&&r(n[o-1])>f;--o)n[o]=n[o-1];n[o]=u}return n}return n}function a(r){function n(r,n,i){return(F>i-n?e:t)(r,n,i)}function t(t,e,i){var o,u=0|(i-e)/6,f=e+u,a=i-1-u,l=e+i-1>>1,s=l-u,h=l+u,c=t[f],v=r(c),p=t[s],g=r(p),d=t[l],y=r(d),b=t[h],x=r(b),k=t[a],m=r(k);v>g&&(o=c,c=p,p=o,o=v,v=g,g=o),x>m&&(o=b,b=k,k=o,o=x,x=m,m=o),v>y&&(o=c,c=d,d=o,o=v,v=y,y=o),g>y&&(o=p,p=d,d=o,o=g,g=y,y=o),v>x&&(o=c,c=b,b=o,o=v,v=x,x=o),y>x&&(o=d,d=b,b=o,o=y,y=x,x=o),g>m&&(o=p,p=k,k=o,o=g,g=m,m=o),g>y&&(o=p,p=d,d=o,o=g,g=y,y=o),x>m&&(o=b,b=k,k=o,o=x,x=m,m=o);var z=p,E=g,A=b,w=x;t[f]=c,t[s]=t[e],t[l]=d,t[h]=t[i-1],t[a]=k;var O=e+1,M=i-2,N=w>=E&&E>=w;if(N)for(var C=O;M>=C;++C){var S=t[C],U=r(S);if(E>U)C!==O&&(t[C]=t[O],t[O]=S),++O;else if(U>E)for(;;){var _=r(t[M]);{if(!(_>E)){if(E>_){t[C]=t[O],t[O++]=t[M],t[M--]=S;break}t[C]=t[M],t[M--]=S;break}M--}}}else for(var C=O;M>=C;C++){var S=t[C],U=r(S);if(E>U)C!==O&&(t[C]=t[O],t[O]=S),++O;else if(U>w)for(;;){var _=r(t[M]);{if(!(_>w)){E>_?(t[C]=t[O],t[O++]=t[M],t[M--]=S):(t[C]=t[M],t[M--]=S);break}if(M--,C>M)break}}}if(t[e]=t[O-1],t[O-1]=z,t[i-1]=t[M+1],t[M+1]=A,n(t,e,O-1),n(t,M+2,i),N)return t;if(f>O&&M>a){for(var F,_;(F=r(t[O]))<=E&&F>=E;)++O;for(;(_=r(t[M]))<=w&&_>=w;)--M;for(var C=O;M>=C;C++){var S=t[C],U=r(S);if(E>=U&&U>=E)C!==O&&(t[C]=t[O],t[O]=S),O++;else if(w>=U&&U>=w)for(;;){var _=r(t[M]);{if(!(w>=_&&_>=w)){E>_?(t[C]=t[O],t[O++]=t[M],t[M--]=S):(t[C]=t[M],t[M--]=S);break}if(M--,C>M)break}}}}return n(t,O,M+1)}var e=f(r);return n}function s(r){for(var n=Array(r),t=-1;++t<r;)n[t]=0;return n}function h(r,n){for(var t=r.length;n>t;)r[t++]=0;return r}function c(r,n){if(n>32)throw Error("invalid array width!");return r}function v(r){this.length=r,this.subarrays=1,this.width=8,this.masks={0:0},this[0]=J(r)}function p(r,n){return function(t){var e=t.length;return[r.left(t,n,0,e),r.right(t,n,0,e)]}}function g(r,n){var t=n[0],e=n[1];return function(n){var i=n.length;return[r.left(n,t,0,i),r.left(n,e,0,i)]}}function d(r){return[0,r.length]}function y(){return null}function b(){return 0}function x(r){return r+1}function m(r){return r-1}function z(r){return function(n,t){return n+ +r(t)}}function E(r){return function(n,t){return n-r(t)}}function A(){function r(r){var n=J,t=r.length;return t&&(F=F.concat(r),U.lengthen(J+=t),q.forEach(function(e){e(r,n,t)}),S("dataAdded")),_}function e(){for(var r=w(J,J),n=[],t=0,e=0;J>t;++t)U.zero(t)?n.push(t):r[t]=e++;R.forEach(function(r){r(-1,-1,[],n,!0)}),D.forEach(function(n){n(r)});for(var t=0,e=0;J>t;++t)U.zero(t)||(t!==e&&(U.copy(e,t),F[e]=F[t]),++e);F.length=J=e,U.truncate(e),S("dataRemoved")}function f(r,n){var t,e,i,o,u=Array(U.subarrays);for(t=0;t<U.subarrays;t++)u[t]=-1;if(n)for(e=0,o=n.length;o>e;e++)i=n[e].id(),u[i>>7]&=~(1<<(63&i));return U.zeroExceptMask(r,u)}function s(r,e){function f(n,o,u){if(e){for(bn=0,p=0,k=[],i=0;i<n.length;i++)for(p=0,k=r(n[i]);p<k.length;p++)bn++;nn=[],on=O(n.length),fn=w(bn,1),ln=[];var f=O(bn);for(l=0,i=0;i<n.length;i++)if(k=r(n[i]),k.length)for(on[i]=k.length,p=0;p<k.length;p++)nn.push(k[p]),f[l]=i,l++;else on[i]=0,ln.push(i);var a=cn(O(bn),0,bn);nn=t(nn,a),tn=t(f,a)}else nn=n.map(r),tn=cn(O(u),0,u),nn=t(nn,tn);e&&(u=bn);var s=vn(nn),h=s[0],c=s[1];if(sn)for(i=0;u>i;++i)sn(nn[i],i)||(U[W][tn[i]+o]|=T,e&&(fn[i]=1));else{for(i=0;h>i;++i)U[W][tn[i]+o]|=T,e&&(fn[i]=1);for(i=c;u>i;++i)U[W][tn[i]+o]|=T,e&&(fn[i]=1)}if(!o)return Y=nn,Z=tn,en=on,un=fn,dn=h,yn=c,void 0;if($=Y,rn=Z,an=un,i0=0,i1=0,e&&(old_n0=o,o=$.length,u=bn),Y=e?Array(o+u):Array(J),Z=e?Array(o+u):w(J,J),e&&(un=w(o+u,1)),e){var v=en.length;en=j(en,J);for(var p=0;J>p+v;p++)en[p+v]=on[p]}for(i=0;o>i0&&u>i1;++i)$[i0]<nn[i1]?(Y[i]=$[i0],e&&(un[i]=an[i0]),Z[i]=rn[i0++]):(Y[i]=nn[i1],e&&(un[i]=an[i1]),Z[i]=tn[i1++]+(e?old_n0:o));for(;o>i0;++i0,++i)Y[i]=$[i0],e&&(un[i]=an[i0]),Z[i]=rn[i0];for(;u>i1;++i1,++i)Y[i]=nn[i1],e&&(un[i]=an[i1]),Z[i]=tn[i1]+(e?old_n0:o);s=vn(Y),dn=s[0],yn=s[1]}function s(r,n,t){pn.forEach(function(r){r(nn,tn,n,t)}),nn=tn=null}function h(r){for(var n,t=0,e=0;J>t;++t)U.zero(n=Z[t])||(t!==e&&(Y[e]=Y[t]),Z[e]=r[n],++e);for(Y.length=e;J>e;)Z[e++]=0;var i=vn(Y);dn=i[0],yn=i[1]}function c(r){var n=r[0],t=r[1];if(sn)return sn=null,H(function(r,e){return e>=n&&t>e},0===r[0]&&r[1]===Z.length),dn=n,yn=t,hn;var i,o,u,f=[],a=[],l=[],s=[];if(dn>n)for(i=n,o=Math.min(dn,t);o>i;++i)f.push(Z[i]),l.push(i);else if(n>dn)for(i=dn,o=Math.min(n,yn);o>i;++i)a.push(Z[i]),s.push(i);if(t>yn)for(i=Math.max(n,yn),o=t;o>i;++i)f.push(Z[i]),l.push(i);else if(yn>t)for(i=Math.max(dn,t),o=yn;o>i;++i)a.push(Z[i]),s.push(i);if(e){var h=[],c=[];for(i=0;i<f.length;i++)en[f[i]]++,un[l[i]]=0,1===en[f[i]]&&(U[W][f[i]]^=T,h.push(f[i]));for(i=0;i<a.length;i++)en[a[i]]--,un[s[i]]=1,0===en[a[i]]&&(U[W][a[i]]^=T,c.push(a[i]));if(f=h,a=c,0===r[0]&&r[1]===Z.length)for(i=0;i<ln.length;i++)U[W][u=ln[i]]&T&&(U[W][u]^=T,f.push(u));else for(i=0;i<ln.length;i++)U[W][u=ln[i]]&T||(U[W][u]^=T,a.push(u))}else{for(i=0;i<f.length;i++)U[W][f[i]]^=T;for(i=0;i<a.length;i++)U[W][a[i]]^=T}return dn=n,yn=t,R.forEach(function(r){r(T,W,f,a)}),S("filtered"),hn}function v(r){return null==r?_():Array.isArray(r)?C(r):"function"==typeof r?G(r):A(r)}function A(r){return c((vn=p(N,r))(Y))}function C(r){return c((vn=g(N,r))(Y))}function _(){return c((vn=d)(Y))}function G(r){return vn=d,H(sn=r,!1),dn=0,yn=J,hn}function H(r,n){var t,i,o,u=[],f=[],a=[],l=[],s=Z.length;if(!e)for(t=0;s>t;++t)!(U[W][i=Z[t]]&T)^!!(o=r(Y[t],t))&&(o?u.push(i):f.push(i));if(e)for(t=0;s>t;++t)r(Y[t],t)?(u.push(Z[t]),a.push(t)):(f.push(Z[t]),l.push(t));if(e){var h=[],c=[];for(t=0;t<u.length;t++)1===un[a[t]]&&(en[u[t]]++,un[a[t]]=0,1===en[u[t]]&&(U[W][u[t]]^=T,h.push(u[t])));for(t=0;t<f.length;t++)0===un[l[t]]&&(en[f[t]]--,un[l[t]]=1,0===en[f[t]]&&(U[W][f[t]]^=T,c.push(f[t])));if(u=h,f=c,n)for(t=0;t<ln.length;t++)U[W][i=ln[t]]&T&&(U[W][i]^=T,u.push(i));else for(t=0;t<ln.length;t++)U[W][i=ln[t]]&T||(U[W][i]^=T,f.push(i))}else{for(t=0;t<u.length;t++)U[W][u[t]]&T&&(U[W][u[t]]&=V);for(t=0;t<f.length;t++)U[W][f[t]]&T||(U[W][f[t]]|=T)}R.forEach(function(r){r(T,W,u,f)}),S("filtered")}function I(r,n){var t,i=[],o=yn,u=0;for(n&&n>0&&(u=n);--o>=dn&&r>0;)U.zero(t=Z[o])&&(u>0?--u:(i.push(F[t]),--r));if(e)for(o=0;o<ln.length&&r>0;o++)U.zero(t=ln[o])&&(u>0?--u:(i.push(F[t]),--r));return i}function K(r,n){var t,i,o=[],u=0;if(n&&n>0&&(u=n),e)for(t=0;t<ln.length&&r>0;t++)U.zero(i=ln[t])&&(u>0?--u:(o.push(F[i]),--r));for(t=dn;yn>t&&r>0;)U.zero(i=Z[t])&&(u>0?--u:(o.push(F[i]),--r)),t++;return o}function L(r){function f(n,o,u,f){function a(){return e?(X++,void 0):(++X===Q&&(m=B(m,P<<=1),q=B(q,P),Q=M(P)),void 0)}e&&(n0old=u,u=Y.length-n.length,f=n.length);var v,p,g,d,b,x,k=_,m=e?[]:w(X,Q),z=I,E=K,A=L,O=X,N=0,C=0;for(nn&&(z=A=y),nn&&(E=A=y),_=Array(X),X=0,q=e?O>1?q:[]:O>1?j(q,J):w(J,Q),O&&(g=(p=k[0]).key);f>C&&!((d=r(n[C]))>=d);)++C;for(;f>C;){for(p&&d>=g?(b=p,x=g,m[N]=X,(p=k[++N])&&(g=p.key)):(b={key:d,value:A()},x=d),_[X]=b;x>=d&&(v=o[C]+(e?n0old:u),e?q[v]?q[v].push(X):q[v]=[X]:q[v]=X,b.value=z(b.value,F[v],!0),U.zeroExcept(v,W,V)||(b.value=E(b.value,F[v],!1)),!(++C>=f));)d=r(n[C]);a()}for(;O>N;)_[m[N]=X]=k[N++],a();if(e)for(i=0;J>i;i++)q[i]||(q[i]=[]);if(X>N)if(e)q=t(q,m,!0);else for(N=0;u>N;++N)q[N]=m[q[N]];v=R.indexOf($),X>1?($=l,rn=h):(!X&&tn&&(X=1,_=[{key:null,value:A()}]),1===X?($=s,rn=c):($=y,rn=y),q=null),R[v]=$}function a(){if(X>1){for(var r=X,n=_,t=w(r,r),e=0,i=0;J>e;++e)U.zero(e)||(t[q[i]=q[e]]=1,++i);for(_=[],X=0,e=0;r>e;++e)t[e]&&(t[e]=X++,_.push(n[e]));if(X>1)for(var e=0;i>e;++e)q[e]=t[q[e]];else q=null;R[R.indexOf($)]=X>1?(rn=h,$=l):1===X?(rn=c,$=s):rn=$=y}else if(1===X){if(tn)return;for(var e=0;J>e;++e)if(!U.zero(e))return;_=[],X=0,R[R.indexOf($)]=$=rn=y}}function l(r,n,t,i,o){if(!(r===T&&n===W||nn)){var u,f,a,l,s;if(e){for(u=0,l=t.length;l>u;++u)if(U.zeroExcept(a=t[u],W,V))for(f=0;f<q[a].length;f++)s=_[q[a][f]],s.value=I(s.value,F[a],!1,f);for(u=0,l=i.length;l>u;++u)if(U.onlyExcept(a=i[u],W,V,n,r))for(f=0;f<q[a].length;f++)s=_[q[a][f]],s.value=K(s.value,F[a],o,f)}else{for(u=0,l=t.length;l>u;++u)U.zeroExcept(a=t[u],W,V)&&(s=_[q[a]],s.value=I(s.value,F[a],!1));for(u=0,l=i.length;l>u;++u)U.onlyExcept(a=i[u],W,V,n,r)&&(s=_[q[a]],s.value=K(s.value,F[a],o))}}}function s(r,n,t,e,i){if(!(r===T&&n===W||nn)){var o,u,f,a=_[0];for(o=0,f=t.length;f>o;++o)U.zeroExcept(u=t[o],W,V)&&(a.value=I(a.value,F[u],!1));for(o=0,f=e.length;f>o;++o)U.onlyExcept(u=e[o],W,V,n,r)&&(a.value=K(a.value,F[u],i))}}function h(){var r,n,t;for(r=0;X>r;++r)_[r].value=L();if(e){for(r=0;J>r;++r)for(n=0;n<q[r].length;n++)t=_[q[r][n]],t.value=I(t.value,F[r],!0,n);for(r=0;J>r;++r)if(!U.zeroExcept(r,W,V))for(n=0;n<q[r].length;n++)t=_[q[r][n]],t.value=K(t.value,F[r],!1,n)}else{for(r=0;J>r;++r)t=_[q[r]],t.value=I(t.value,F[r],!0);for(r=0;J>r;++r)U.zeroExcept(r,W,V)||(t=_[q[r]],t.value=K(t.value,F[r],!1))}}function c(){var r,n=_[0];for(n.value=L(),r=0;J>r;++r)n.value=I(n.value,F[r],!0);for(r=0;J>r;++r)U.zeroExcept(r,W,V)||(n.value=K(n.value,F[r],!1))}function v(){return nn&&(rn(),nn=!1),_}function p(r){var n=G(v(),0,_.length,r);return H.sort(n,0,n.length)}function g(r,n,t){return I=r,K=n,L=t,nn=!0,S}function d(){return g(x,m,b)}function k(r){return g(z(r),E(r),b)}function A(r){function n(n){return r(n.value)}return G=u(n),H=o(n),S}function O(){return A(n)}function N(){return X}function C(){var r=R.indexOf($);return r>=0&&R.splice(r,1),r=pn.indexOf(f),r>=0&&pn.splice(r,1),r=D.indexOf(a),r>=0&&D.splice(r,1),S}var S={top:p,all:v,reduce:g,reduceCount:d,reduceSum:k,order:A,orderNatural:O,size:N,dispose:C,remove:C};gn.push(S);var _,q,G,H,I,K,L,P=8,Q=M(P),X=0,$=y,rn=y,nn=!0,tn=r===y;return arguments.length<1&&(r=n),R.push($),pn.push(f),D.push(a),f(Y,Z,0,J),d().orderNatural()}function P(){var r=L(y),n=r.all;return delete r.all,delete r.top,delete r.order,delete r.orderNatural,delete r.size,r.value=function(){return n()[0].value},r}function Q(){gn.forEach(function(r){r.dispose()});var r=q.indexOf(f);return r>=0&&q.splice(r,1),r=q.indexOf(s),r>=0&&q.splice(r,1),r=D.indexOf(h),r>=0&&D.splice(r,1),U.masks[W]&=V,_()}var T,V,W,X,Y,Z,$,rn,nn,tn,en,on,un,fn,an,ln,sn,hn={filter:v,filterExact:A,filterRange:C,filterFunction:G,filterAll:_,top:I,bottom:K,group:L,groupAll:P,dispose:Q,remove:Q,accessor:r,id:function(){return X}},cn=a(function(r){return nn[r]}),vn=d,pn=[],gn=[],dn=0,yn=0,bn=0;q.unshift(f),q.push(s),D.push(h);var xn=U.add();return W=xn.offset,T=xn.one,V=~T,X=W<<7|Math.log(T)/Math.log(2),f(F,0,J),s(F,0,J),hn}function h(){function r(r,n){var t;if(!v)for(t=n;J>t;++t)a=l(a,F[t],!0),U.zero(t)||(a=s(a,F[t],!1))}function n(r,n,t,e,i){var o,u,f;if(!v){for(o=0,f=t.length;f>o;++o)U.zero(u=t[o])&&(a=l(a,F[u],i));for(o=0,f=e.length;f>o;++o)U.only(u=e[o],n,r)&&(a=s(a,F[u],i))}}function t(){var r;for(a=h(),r=0;J>r;++r)a=l(a,F[r],!0),U.zero(r)||(a=s(a,F[r],!1))}function e(r,n,t){return l=r,s=n,h=t,v=!0,c}function i(){return e(x,m,b)}function o(r){return e(z(r),E(r),b)}function u(){return v&&(t(),v=!1),a}function f(){var t=R.indexOf(n);return t>=0&&R.splice(t),t=q.indexOf(r),t>=0&&q.splice(t),c}var a,l,s,h,c={reduce:e,reduceCount:i,reduceSum:o,value:u,dispose:f,remove:f},v=!0;return R.push(n),q.push(r),r(F,0,J),i()}function c(){return J}function A(){return F}function C(r){return"function"!=typeof r?(console.warn("onChange callback parameter must be a function!"),void 0):(G.push(r),function(){G.splice(G.indexOf(r),1)})}function S(r){for(var n=0;n<G.length;n++)G[n](r)}var U,_={add:r,remove:e,dimension:s,groupAll:h,size:c,all:A,onChange:C,isElementFiltered:f},F=[],J=0,R=[],q=[],D=[],G=[];return U=new v(0),arguments.length?r(arguments[0]):_}function w(r,n){return(257>n?J:65537>n?R:q)(r)}function O(r){for(var n=w(r,r),t=-1;++t<r;)n[t]=t;return n}function M(r){return 8===r?256:16===r?65536:4294967296}A.version="1.4.0-alpha.01",A.permute=t;var N=A.bisect=e(n);N.by=e;var C=A.heap=o(n);C.by=o;var S=A.heapselect=u(n);S.by=u;var U=A.insertionsort=f(n);U.by=f;var _=A.quicksort=a(n);_.by=a;var F=32,J=s,R=s,q=s,j=h,B=c;"undefined"!=typeof Uint8Array&&(J=function(r){return new Uint8Array(r)},R=function(r){return new Uint16Array(r)},q=function(r){return new Uint32Array(r)},j=function(r,n){if(r.length>=n)return r;var t=new r.constructor(n);return t.set(r),t},B=function(r,n){var t;switch(n){case 16:t=R(r.length);break;case 32:t=q(r.length);break;default:throw Error("invalid array width!")}return t.set(r),t}),v.prototype.lengthen=function(r){var n,t;for(n=0,t=this.subarrays;t>n;++n)this[n]=j(this[n],r);this.length=r},v.prototype.add=function(){var r,n,t,e,i;for(e=0,i=this.subarrays;i>e;++e)if(r=this.masks[e],n=this.width-32*e,t=~r&-~r,!(n>=32)||t)return 32>n&&t&1<<n&&(this[e]=B(this[e],n<<=1),this.width=32*e+n),this.masks[e]|=t,{offset:e,one:t};return this[this.subarrays]=J(this.length),this.masks[this.subarrays]=1,this.width+=8,{offset:this.subarrays++,one:1}},v.prototype.copy=function(r,n){var t,e;for(t=0,e=this.subarrays;e>t;++t)this[t][r]=this[t][n]},v.prototype.truncate=function(r){var n,t;for(n=0,t=this.subarrays;t>n;++n){for(var e=this.length-1;e>=r;e--)this[n][e]=0;this[n].length=r}this.length=r},v.prototype.zero=function(r){var n,t;for(n=0,t=this.subarrays;t>n;++n)if(this[n][r])return!1;return!0},v.prototype.zeroExcept=function(r,n,t){var e,i;for(e=0,i=this.subarrays;i>e;++e)if(e===n?this[e][r]&t:this[e][r])return!1;return!0},v.prototype.zeroExceptMask=function(r,n){var t,e;for(t=0,e=this.subarrays;e>t;++t)if(this[t][r]&n[t])return!1;return!0},v.prototype.only=function(r,n,t){var e,i;for(e=0,i=this.subarrays;i>e;++e)if(this[e][r]!=(e===n?t:0))return!1;return!0},v.prototype.onlyExcept=function(r,n,t,e,i){var o,u,f;for(u=0,f=this.subarrays;f>u;++u)if(o=this[u][r],u===n&&(o&=t),o!=(u===e?i:0))return!1;return!0},r.crossfilter=A}("undefined"!=typeof exports&&exports||this);