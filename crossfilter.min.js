!function(r){function n(r){return r}function e(r,n){for(var t=0,e=n.length,i=Array(e);e>t;++t)i[t]=r[n[t]];return i}function u(r){function n(n,t,e,i){for(;i>e;){var u=e+i>>>1;r(n[u])<t?e=u+1:i=u}return e}function t(n,t,e,i){for(;i>e;){var u=e+i>>>1;t<r(n[u])?i=u:e=u+1}return e}return t.right=t,t.left=n,t}function o(r){function n(r,n,t){for(var i=t-n,u=(i>>>1)+1;--u>0;)e(r,u,i,n);return r}function t(r,n,t){for(var i,u=t-n;--u>0;)i=r[n],r[n]=r[n+u],r[n+u]=i,e(r,1,u,n);return r}function e(n,t,e,i){for(var u,o=n[--i+t],f=r(o);(u=t<<1)<=e&&(e>u&&r(n[i+u])>r(n[i+u+1])&&u++,!(f<=r(n[i+u])));)n[i+t]=n[i+u],t=u;n[i+t]=o}return n.sort=t,n}function f(r){function n(n,e,i,u){var o,f,a,l,c=Array(u=Math.min(i-e,u));for(f=0;u>f;++f)c[f]=n[e++];if(t(c,0,u),i>e){o=r(c[0]);do(a=r(l=n[e])>o)&&(c[0]=l,o=r(t(c,0,u)[0]));while(++e<i)}return c}var t=o(r);return n}function a(r){function n(n,t,e){for(var i=t+1;e>i;++i){for(var u=i,o=n[i],f=r(o);u>t&&r(n[u-1])>f;--u)n[u]=n[u-1];n[u]=o}return n}return n}function c(r){function n(r,n,i){return(R>i-n?e:t)(r,n,i)}function t(t,e,i){var u,o=0|(i-e)/6,f=e+o,a=i-1-o,l=e+i-1>>1,c=l-o,s=l+o,h=t[f],v=r(h),p=t[c],g=r(p),d=t[l],y=r(d),b=t[s],x=r(b),k=t[a],m=r(k);v>g&&(u=h,h=p,p=u,u=v,v=g,g=u),x>m&&(u=b,b=k,k=u,u=x,x=m,m=u),v>y&&(u=h,h=d,d=u,u=v,v=y,y=u),g>y&&(u=p,p=d,d=u,u=g,g=y,y=u),v>x&&(u=h,h=b,b=u,u=v,v=x,x=u),y>x&&(u=d,d=b,b=u,u=y,y=x,x=u),g>m&&(u=p,p=k,k=u,u=g,g=m,m=u),g>y&&(u=p,p=d,d=u,u=g,g=y,y=u),x>m&&(u=b,b=k,k=u,u=x,x=m,m=u);var z=p,E=g,w=b,A=x;t[f]=h,t[c]=t[e],t[l]=d,t[s]=t[i-1],t[a]=k;var O=e+1,j=i-2,M=A>=E&&E>=A;if(M)for(var C=O;j>=C;++C){var U=t[C],N=r(U);if(E>N)C!==O&&(t[C]=t[O],t[O]=U),++O;else if(N>E)for(;;){var S=r(t[j]);{if(!(S>E)){if(E>S){t[C]=t[O],t[O++]=t[j],t[j--]=U;break}t[C]=t[j],t[j--]=U;break}j--}}}else for(var C=O;j>=C;C++){var U=t[C],N=r(U);if(E>N)C!==O&&(t[C]=t[O],t[O]=U),++O;else if(N>A)for(;;){var S=r(t[j]);{if(!(S>A)){E>S?(t[C]=t[O],t[O++]=t[j],t[j--]=U):(t[C]=t[j],t[j--]=U);break}if(j--,C>j)break}}}if(t[e]=t[O-1],t[O-1]=z,t[i-1]=t[j+1],t[j+1]=w,n(t,e,O-1),n(t,j+2,i),M)return t;if(f>O&&j>a){for(var q,S;(q=r(t[O]))<=E&&q>=E;)++O;for(;(S=r(t[j]))<=A&&S>=A;)--j;for(var C=O;j>=C;C++){var U=t[C],N=r(U);if(E>=N&&N>=E)C!==O&&(t[C]=t[O],t[O]=U),O++;else if(A>=N&&N>=A)for(;;){var S=r(t[j]);{if(!(A>=S&&S>=A)){E>S?(t[C]=t[O],t[O++]=t[j],t[j--]=U):(t[C]=t[j],t[j--]=U);break}if(j--,C>j)break}}}}return n(t,O,j+1)}var e=a(r);return n}function s(r){for(var n=Array(r),t=-1;++t<r;)n[t]=0;return n}function h(r,n){for(var t=r.length;n>t;)r[t++]=0;return r}function v(r,n){if(n>32)throw Error("invalid array width!");return r}function p(r){this.length=r,this.subarrays=1,this.width=8,this.masks={0:0},this[0]=B(r)}function g(r,n){return function(t){var e=t.length;return[r.left(t,n,0,e),r.right(t,n,0,e)]}}function d(r,n){var t=n[0],e=n[1];return function(n){var i=n.length;return[r.left(n,t,0,i),r.left(n,e,0,i)]}}function y(r){return[0,r.length]}function b(){return null}function x(){return 0}function m(r){return r+1}function z(r){return r-1}function E(r){return function(n,t){return n+ +r(t)}}function w(r){return function(n,t){return n-r(t)}}function A(){function r(r){var n=R,t=r.length;return t&&(F=F.concat(r),S.lengthen(R+=t),D.forEach(function(e){e(r,n,t)}),N()),q}function u(){for(var r=O(R,R),n=[],t=0,e=0;R>t;++t)S.zero(t)?n.push(t):r[t]=e++;B.forEach(function(r){r(-1,-1,[],n,!0)}),G.forEach(function(n){n(r)});for(var t=0,e=0;R>t;++t)S.zero(t)||(t!==e&&(S.copy(e,t),F[e]=F[t]),++e);F.length=R=e,S.truncate(e),N()}function a(r,u){function a(n,o,f){if(u){for(t=0,j=0,k=[],i=0;i<n.length;i++)for(j=0,k=r(n[i]);j<k.length;j++)t++;rn=[],tn=M(R),en=[];var a=M(t);for(l=0,i=0;i<n.length;i++)if(k=r(n[i]),k.length)for(tn[i]=k.length,j=0;j<k.length;j++)rn.push(k[j]),a[l]=i,l++;else tn[i]=0,en.push(i);var c=fn(M(t),0,t);rn=e(rn,c),nn=e(a,c)}else rn=n.map(r),nn=fn(M(f),0,f),rn=e(rn,nn);var s=an(rn),h=s[0],v=s[1];if(un)for(i=0;f>i;++i)un(rn[i],i)||(S[Z][nn[i]+o]|=X);else{for(i=0;h>i;++i)S[Z][nn[i]+o]|=X;for(i=v;f>i;++i)S[Z][nn[i]+o]|=X}if(!o)return $=rn,_=nn,sn=h,hn=v,void 0;var p=$,g=_,d=0,y=0;for($=Array(R),_=O(R,R),i=0;o>d&&f>y;++i)p[d]<rn[y]?($[i]=p[d],_[i]=g[d++]):($[i]=rn[y],_[i]=nn[y++]+o);for(;o>d;++d,++i)$[i]=p[d],_[i]=g[d];for(;f>y;++y,++i)$[i]=rn[y],_[i]=nn[y]+o;s=an($),sn=s[0],hn=s[1]}function s(r,n,t){ln.forEach(function(r){r(rn,nn,n,t)}),rn=nn=null}function h(r){for(var n,t=0,e=0;R>t;++t)S.zero(n=_[t])||(t!==e&&($[e]=$[t]),_[e]=r[n],++e);for($.length=e;R>e;)_[e++]=0;var i=an($);sn=i[0],hn=i[1]}function v(r){var n=r[0],t=r[1];if(un)return un=null,L(function(r,e){return e>=n&&t>e}),sn=n,hn=t,on;var e,i,o,f=[],a=[];if(sn>n)for(e=n,i=Math.min(sn,t);i>e;++e)S[Z][o=_[e]]^=X,f.push(o);else if(n>sn)for(e=sn,i=Math.min(n,hn);i>e;++e)S[Z][o=_[e]]^=X,a.push(o);if(t>hn)for(e=Math.max(n,hn),i=t;i>e;++e)S[Z][o=_[e]]^=X,f.push(o);else if(hn>t)for(e=Math.max(sn,t),i=hn;i>e;++e)S[Z][o=_[e]]^=X,a.push(o);if(u){var l=[],c=[];for(e=0;e<f.length;e++)tn[f[e]]++,1===tn[f[e]]&&l.push(f[e]);for(e=0;e<a.length;e++)tn[a[e]]--,0===tn[a[e]]&&c.push(a[e]);if(f=l,a=c,0===r[0]&&r[1]===_.length)for(e=0;e<en.length;e++)S[Z][o=en[e]]&X&&(S[Z][o]^=X,f.push(o));else for(e=0;e<en.length;e++)S[Z][o=en[e]]&X||(S[Z][o]^=X,a.push(o))}return sn=n,hn=t,B.forEach(function(r){r(X,Z,f,a)}),N(),on}function p(r){return null==r?J():Array.isArray(r)?q(r):"function"==typeof r?K(r):A(r)}function A(r){return v((an=g(U,r))($))}function q(r){return v((an=d(U,r))($))}function J(){return v((an=y)($))}function K(r){return an=y,L(un=r),sn=0,hn=R,on}function L(r){var n,t,e,i=[],u=[];for(n=0;R>n;++n)!(S[Z][t=_[n]]&X)^!!(e=r($[n],n))&&(e?(S[Z][t]&=Y,i.push(t)):(S[Z][t]|=X,u.push(t)));B.forEach(function(r){r(X,Z,i,u)}),N()}function P(r){var n,t=[],e=hn;if(u){for(;--e>=sn&&r>0;)S.zero(n=_[e])&&(t.push(F[n]),--r);for(e=0;e<en.length&&r>0;e++)t.push(F[en[e]]),--r;return t}for(;--e>=sn&&r>0;)S.zero(n=_[e])&&(t.push(F[n]),--r);return t}function Q(r){var n,t=[],e=sn;if(u)for(e=0;e<en.length&&r>0;e++)t.push(F[en[e]]),--r;for(;hn>e&&r>0;)S.zero(n=_[e])&&(t.push(F[n]),--r),e++;return t}function T(r){function t(n,t,e,o){function f(){return u?(T++,void 0):(++T===Q&&(k=I(k,P<<=1),N=I(N,P),Q=C(P)),void 0)}u&&(o=e+n.length);var h,v,p,g,d,y,x=U,k=u?[]:O(T,Q),m=J,z=K,E=L,w=T,A=0,j=0;for(rn&&(m=E=b),rn&&(z=E=b),U=Array(T),T=0,N=u?w>1?N:[]:w>1?H(N,R):O(R,Q),w&&(p=(v=x[0]).key);o>j&&!((g=r(n[j]))>=g);)++j;for(;o>j;){for(v&&g>=p?(d=v,y=p,k[A]=T,(v=x[++A])&&(p=v.key)):(d={key:g,value:E()},y=g),U[T]=d;y>=g&&(h=t[j]+e,u?N[h]?N[h].push(T):N[h]=[T]:N[h]=T,d.value=m(d.value,F[h],!0),S.zeroExcept(h,Z,Y)||(d.value=z(d.value,F[h],!1)),!(++j>=o));)g=r(n[j]);f()}for(;w>A;)U[k[A]=T]=x[A++],f();if(u)for(i=0;i<N.length;i++)N[i]||(N[i]=[]);if(T>A)for(A=0;e>A;++A)N[A]=k[N[A]];h=B.indexOf(V),T>1?(V=a,W=c):(!T&&nn&&(T=1,U=[{key:null,value:E()}]),1===T?(V=l,W=s):(V=b,W=b),N=null),B[h]=V}function e(){if(T>1){for(var r=T,n=U,t=O(r,r),e=0,i=0;R>e;++e)S.zero(e)||(t[N[i]=N[e]]=1,++i);for(U=[],T=0,e=0;r>e;++e)t[e]&&(t[e]=T++,U.push(n[e]));if(T>1)for(var e=0;i>e;++e)N[e]=t[N[e]];else N=null;B[B.indexOf(V)]=T>1?(W=c,V=a):1===T?(W=s,V=l):W=V=b}else if(1===T){if(nn)return;for(var e=0;R>e;++e)if(!S.zero(e))return;U=[],T=0,B[B.indexOf(V)]=V=W=b}}function a(r,n,t,e,i){if(!(r===X&&n===Z||rn)){var o,f,a,l,c;if(u){for(o=0,l=t.length;l>o;++o)if(S.zeroExcept(a=t[o],Z,Y))for(f=0;f<N[a].length;f++)c=U[N[a][f]],c.value=J(c.value,F[a],!1,f);for(o=0,l=e.length;l>o;++o)if(S.onlyExcept(a=e[o],Z,Y,n,r))for(f=0;f<N[a].length;f++)c=U[N[a][f]],c.value=K(c.value,F[a],i,f)}else{for(o=0,l=t.length;l>o;++o)S.zeroExcept(a=t[o],Z,Y)&&(c=U[N[a]],c.value=J(c.value,F[a],!1));for(o=0,l=e.length;l>o;++o)S.onlyExcept(a=e[o],Z,Y,n,r)&&(c=U[N[a]],c.value=K(c.value,F[a],i))}}}function l(r,n,t,e,i){if(!(r===X&&n===Z||rn)){var u,o,f,a=U[0];for(u=0,f=t.length;f>u;++u)S.zeroExcept(o=t[u],Z,Y)&&(a.value=J(a.value,F[o],!1));for(u=0,f=e.length;f>u;++u)S.onlyExcept(o=e[u],Z,Y,n,r)&&(a.value=K(a.value,F[o],i))}}function c(){var r,n,t;for(r=0;T>r;++r)U[r].value=L();if(u){for(r=0;R>r;++r)for(n=0;n<N[r].length;n++)t=U[N[r][n]],t.value=J(t.value,F[r],!0,n);for(r=0;R>r;++r)if(!S.zeroExcept(r,Z,Y))for(n=0;n<N[r].length;n++)t=U[N[r][n]],t.value=K(t.value,F[r],!1,n)}else{for(r=0;R>r;++r)t=U[N[r]],t.value=J(t.value,F[r],!0);for(r=0;R>r;++r)S.zeroExcept(r,Z,Y)||(t=U[N[r]],t.value=K(t.value,F[r],!1))}}function s(){var r,n=U[0];for(n.value=L(),r=0;R>r;++r)n.value=J(n.value,F[r],!0);for(r=0;R>r;++r)S.zeroExcept(r,Z,Y)||(n.value=K(n.value,F[r],!1))}function h(){return rn&&(W(),rn=!1),U}function v(r){var n=q(h(),0,U.length,r);return D.sort(n,0,n.length)}function p(r,n,t){return J=r,K=n,L=t,rn=!0,M}function g(){return p(m,z,x)}function d(r){return p(E(r),w(r),x)}function y(r){function n(n){return r(n.value)}return q=f(n),D=o(n),M}function k(){return y(n)}function A(){return T}function j(){var r=B.indexOf(V);return r>=0&&B.splice(r,1),r=ln.indexOf(t),r>=0&&ln.splice(r,1),r=G.indexOf(e),r>=0&&G.splice(r,1),M}var M={top:v,all:h,reduce:p,reduceCount:g,reduceSum:d,order:y,orderNatural:k,size:A,dispose:j,remove:j};cn.push(M);var U,N,q,D,J,K,L,P=8,Q=C(P),T=0,V=b,W=b,rn=!0,nn=r===b;return arguments.length<1&&(r=n),B.push(V),ln.push(t),G.push(e),t($,_,0,R),g().orderNatural()}function V(){var r=T(b),n=r.all;return delete r.all,delete r.top,delete r.order,delete r.orderNatural,delete r.size,r.value=function(){return n()[0].value},r}function W(){cn.forEach(function(r){r.dispose()});var r=D.indexOf(a);return r>=0&&D.splice(r,1),r=D.indexOf(s),r>=0&&D.splice(r,1),r=G.indexOf(h),r>=0&&G.splice(r,1),S.masks[Z]&=Y,J()}var X,Y,Z,$,_,rn,nn,tn,en,un,on={filter:p,filterExact:A,filterRange:q,filterFunction:K,filterAll:J,top:P,bottom:Q,group:T,groupAll:V,dispose:W,remove:W},fn=c(function(r){return rn[r]}),an=y,ln=[],cn=[],sn=0,hn=0;D.unshift(a),D.push(s),G.push(h);var vn=S.add();return Z=vn.offset,X=vn.one,Y=~X,a(F,0,R),s(F,0,R),on}function s(){function r(r,n){var t;if(!v)for(t=n;R>t;++t)a=l(a,F[t],!0),S.zero(t)||(a=c(a,F[t],!1))}function n(r,n,t,e,i){var u,o,f;if(!v){for(u=0,f=t.length;f>u;++u)S.zero(o=t[u])&&(a=l(a,F[o],i));for(u=0,f=e.length;f>u;++u)S.only(o=e[u],n,r)&&(a=c(a,F[o],i))}}function t(){var r;for(a=s(),r=0;R>r;++r)a=l(a,F[r],!0),S.zero(r)||(a=c(a,F[r],!1))}function e(r,n,t){return l=r,c=n,s=t,v=!0,h}function i(){return e(m,z,x)}function u(r){return e(E(r),w(r),x)}function o(){return v&&(t(),v=!1),a}function f(){var t=B.indexOf(n);return t>=0&&B.splice(t),t=D.indexOf(r),t>=0&&D.splice(t),h}var a,l,c,s,h={reduce:e,reduceCount:i,reduceSum:u,value:o,dispose:f,remove:f},v=!0;return B.push(n),D.push(r),r(F,0,R),i()}function h(){return R}function v(){return F}function A(r){return"function"!=typeof r?(console.warn("onChange callback parameter must be a function!"),void 0):(J.push(r),function(){J.splice(J.indexOf(r),1)})}function N(){for(var r=0;r<J.length;r++)J[r]()}var S,q={add:r,remove:u,dimension:a,groupAll:s,size:h,all:v,onChange:A},F=[],R=0,B=[],D=[],G=[],J=[];return S=new p(0),arguments.length?r(arguments[0]):q}function O(r,n){return(257>n?B:65537>n?D:G)(r)}function M(r){for(var n=O(r,r),t=-1;++t<r;)n[t]=t;return n}function C(r){return 8===r?256:16===r?65536:4294967296}A.version="2.0.0-alpha.03",A.permute=e;var U=A.bisect=u(n);U.by=u;var N=A.heap=o(n);N.by=o;var S=A.heapselect=f(n);S.by=f;var q=A.insertionsort=a(n);q.by=a;var F=A.quicksort=c(n);F.by=c;var R=32,B=s,D=s,G=s,H=h,I=v;"undefined"!=typeof Uint8Array&&(B=function(r){return new Uint8Array(r)},D=function(r){return new Uint16Array(r)},G=function(r){return new Uint32Array(r)},H=function(r,n){if(r.length>=n)return r;var t=new r.constructor(n);return t.set(r),t},I=function(r,n){var t;switch(n){case 16:t=D(r.length);break;case 32:t=G(r.length);break;default:throw Error("invalid array width!")}return t.set(r),t}),p.prototype.lengthen=function(r){var n,t;for(n=0,t=this.subarrays;t>n;++n)this[n]=H(this[n],r);this.length=r},p.prototype.add=function(){var r,n,t,e,i;for(e=0,i=this.subarrays;i>e;++e)if(r=this.masks[e],n=this.width-32*e,t=~r&-~r,!(n>=32)||t)return 32>n&&t&1<<n&&(this[e]=I(this[e],n<<=1),this.width=32*e+n),this.masks[e]|=t,{offset:e,one:t};return this[this.subarrays]=B(this.length),this.masks[this.subarrays]=1,this.width+=8,{offset:this.subarrays++,one:1}},p.prototype.copy=function(r,n){var t,e;for(t=0,e=this.subarrays;e>t;++t)this[t][r]=this[t][n]},p.prototype.truncate=function(r){var n,t;for(n=0,t=this.subarrays;t>n;++n){for(var e=this.length-1;e>=r;e--)this[n][e]=0;this[n].length=r}this.length=r},p.prototype.zero=function(r){var n,t;for(n=0,t=this.subarrays;t>n;++n)if(this[n][r])return!1;return!0},p.prototype.zeroExcept=function(r,n,t){var e,i;for(e=0,i=this.subarrays;i>e;++e)if(e===n?this[e][r]&t:this[e][r])return!1;return!0},p.prototype.only=function(r,n,t){var e,i;for(e=0,i=this.subarrays;i>e;++e)if(this[e][r]!=(e===n?t:0))return!1;return!0},p.prototype.onlyExcept=function(r,n,t,e,i){var u,o,f;for(o=0,f=this.subarrays;f>o;++o)if(u=this[o][r],o===n&&(u&=t),u!=(o===e?i:0))return!1;return!0},r.crossfilter=A}("undefined"!=typeof exports&&exports||this);