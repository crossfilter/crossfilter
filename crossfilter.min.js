!function(r){function n(r){return r}function e(r,n){for(var t=0,e=n.length,o=Array(e);e>t;++t)o[t]=r[n[t]];return o}function o(r){function n(n,t,e,o){for(;o>e;){var u=e+o>>>1;r(n[u])<t?e=u+1:o=u}return e}function t(n,t,e,o){for(;o>e;){var u=e+o>>>1;t<r(n[u])?o=u:e=u+1}return e}return t.right=t,t.left=n,t}function u(r){function n(r,n,t){for(var o=t-n,u=(o>>>1)+1;--u>0;)e(r,u,o,n);return r}function t(r,n,t){for(var o,u=t-n;--u>0;)o=r[n],r[n]=r[n+u],r[n+u]=o,e(r,1,u,n);return r}function e(n,t,e,o){for(var u,i=n[--o+t],f=r(i);(u=t<<1)<=e&&(e>u&&r(n[o+u])>r(n[o+u+1])&&u++,!(f<=r(n[o+u])));)n[o+t]=n[o+u],t=u;n[o+t]=i}return n.sort=t,n}function f(r){function n(n,e,o,u){var i,f,a,c,s=Array(u=Math.min(o-e,u));for(f=0;u>f;++f)s[f]=n[e++];if(t(s,0,u),o>e){i=r(s[0]);do(a=r(c=n[e])>i)&&(s[0]=c,i=r(t(s,0,u)[0]));while(++e<o)}return s}var t=u(r);return n}function a(r){function n(n,t,e){for(var o=t+1;e>o;++o){for(var u=o,i=n[o],f=r(i);u>t&&r(n[u-1])>f;--u)n[u]=n[u-1];n[u]=i}return n}return n}function c(r){function n(r,n,o){return(q>o-n?e:t)(r,n,o)}function t(t,e,o){var u,i=0|(o-e)/6,f=e+i,a=o-1-i,c=e+o-1>>1,s=c-i,l=c+i,h=t[f],v=r(h),p=t[s],d=r(p),g=t[c],y=r(g),b=t[l],x=r(b),k=t[a],m=r(k);v>d&&(u=h,h=p,p=u,u=v,v=d,d=u),x>m&&(u=b,b=k,k=u,u=x,x=m,m=u),v>y&&(u=h,h=g,g=u,u=v,v=y,y=u),d>y&&(u=p,p=g,g=u,u=d,d=y,y=u),v>x&&(u=h,h=b,b=u,u=v,v=x,x=u),y>x&&(u=g,g=b,b=u,u=y,y=x,x=u),d>m&&(u=p,p=k,k=u,u=d,d=m,m=u),d>y&&(u=p,p=g,g=u,u=d,d=y,y=u),x>m&&(u=b,b=k,k=u,u=x,x=m,m=u);var z=p,w=d,E=b,A=x;t[f]=h,t[s]=t[e],t[c]=g,t[l]=t[o-1],t[a]=k;var O=e+1,j=o-2,C=A>=w&&w>=A;if(C)for(var M=O;j>=M;++M){var U=t[M],N=r(U);if(w>N)M!==O&&(t[M]=t[O],t[O]=U),++O;else if(N>w)for(;;){var I=r(t[j]);{if(!(I>w)){if(w>I){t[M]=t[O],t[O++]=t[j],t[j--]=U;break}t[M]=t[j],t[j--]=U;break}j--}}}else for(var M=O;j>=M;M++){var U=t[M],N=r(U);if(w>N)M!==O&&(t[M]=t[O],t[O]=U),++O;else if(N>A)for(;;){var I=r(t[j]);{if(!(I>A)){w>I?(t[M]=t[O],t[O++]=t[j],t[j--]=U):(t[M]=t[j],t[j--]=U);break}if(j--,M>j)break}}}if(t[e]=t[O-1],t[O-1]=z,t[o-1]=t[j+1],t[j+1]=E,n(t,e,O-1),n(t,j+2,o),C)return t;if(f>O&&j>a){for(var R,I;(R=r(t[O]))<=w&&R>=w;)++O;for(;(I=r(t[j]))<=A&&I>=A;)--j;for(var M=O;j>=M;M++){var U=t[M],N=r(U);if(w>=N&&N>=w)M!==O&&(t[M]=t[O],t[O]=U),O++;else if(A>=N&&N>=A)for(;;){var I=r(t[j]);{if(!(A>=I&&I>=A)){w>I?(t[M]=t[O],t[O++]=t[j],t[j--]=U):(t[M]=t[j],t[j--]=U);break}if(j--,M>j)break}}}}return n(t,O,j+1)}var e=a(r);return n}function s(r){for(var n=Array(r),t=-1;++t<r;)n[t]=0;return n}function h(r,n){for(var t=r.length;n>t;)r[t++]=0;return r}function v(r,n){if(n>32)throw Error("invalid array width!");return r}function p(r){this.length=r,this.subarrays=1,this.width=8,this.masks={0:0},this[0]=F(r)}function d(r,n){return function(t){var e=t.length;return[r.left(t,n,0,e),r.right(t,n,0,e)]}}function g(r,n){var t=n[0],e=n[1];return function(n){var o=n.length;return[r.left(n,t,0,o),r.left(n,e,0,o)]}}function y(r){return[0,r.length]}function b(){return null}function x(){return 0}function m(r){return r+1}function z(r){return r-1}function w(r){return function(n,t){return n+ +r(t)}}function E(r){return function(n,t){return n-r(t)}}function A(){function r(r){var n=q,t=r.length;return t&&(S=S.concat(r),I.lengthen(q+=t),V.forEach(function(e){e(r,n,t)}),N()),R}function o(){for(var r=O(q,q),n=[],t=0,e=0;q>t;++t)I.zero(t)?n.push(t):r[t]=e++;F.forEach(function(r){r(-1,-1,[],n,!0)}),B.forEach(function(n){n(r)});for(var t=0,e=0;q>t;++t)I.zero(t)||(t!==e&&(I.copy(e,t),S[e]=S[t]),++e);S.length=q=e,I.truncate(e),N()}function a(r,o){function a(n,u,f){if(o){for(t=0,j=0,k=[],i=0;i<n.length;i++)for(k=r(n[i]),j=0;j<k.length;j++)t++;rn=[],tn=C(q);var a=C(t);for(l=0,i=0;i<n.length;i++)for(k=r(n[i]),tn[i]=k.length,j=0;j<k.length;j++)rn.push(k[j]),a[l]=i,l++;var c=un(C(t),0,t);rn=e(rn,c),nn=e(a,c),console.log("newValues",rn),console.log("newIndex",nn),console.log("iterablesIndexCount",tn)}else rn=n.map(r),nn=un(C(f),0,f),rn=e(rn,nn);var s=fn(rn),h=s[0],v=s[1];if(en)for(i=0;f>i;++i)en(rn[i],i)||(I[Z][nn[i]+u]|=X);else{for(i=0;h>i;++i)I[Z][nn[i]+u]|=X;for(i=v;f>i;++i)I[Z][nn[i]+u]|=X}if(!u)return $=rn,_=nn,sn=h,ln=v,void 0;var p=$,d=_,g=0,y=0;for($=Array(q),_=O(q,q),i=0;u>g&&f>y;++i)p[g]<rn[y]?($[i]=p[g],_[i]=d[g++]):($[i]=rn[y],_[i]=nn[y++]+u);for(;u>g;++g,++i)$[i]=p[g],_[i]=d[g];for(;f>y;++y,++i)$[i]=rn[y],_[i]=nn[y]+u;s=fn($),sn=s[0],ln=s[1]}function s(r,n,t){an.forEach(function(r){r(rn,nn,n,t)}),rn=nn=null}function h(r){for(var n,t=0,e=0;q>t;++t)I.zero(n=_[t])||(t!==e&&($[e]=$[t]),_[e]=r[n],++e);for($.length=e;q>e;)_[e++]=0;var o=fn($);sn=o[0],ln=o[1]}function v(r){var n=r[0],t=r[1];if(en)return en=null,K(function(r,e){return e>=n&&t>e}),sn=n,ln=t,on;var e,u,i,f=[],a=[];if(sn>n)for(e=n,u=Math.min(sn,t);u>e;++e)I[Z][i=_[e]]^=X,f.push(i);else if(n>sn)for(e=sn,u=Math.min(n,ln);u>e;++e)I[Z][i=_[e]]^=X,a.push(i);if(t>ln)for(e=Math.max(n,ln),u=t;u>e;++e)I[Z][i=_[e]]^=X,f.push(i);else if(ln>t)for(e=Math.max(sn,t),u=ln;u>e;++e)I[Z][i=_[e]]^=X,a.push(i);if(o){var c=[],s=[];for(e=0;e<f.length;e++)tn[f[e]]++,1===tn[f[e]]&&c.push(f[e]);for(e=0;e<a.length;e++)tn[a[e]]--,0===tn[a[e]]&&s.push(a[e]);f=c,a=s,console.log("newAdded",c),console.log("newRemoved",s)}return sn=n,ln=t,F.forEach(function(r){r(X,Z,f,a)}),N(),on}function p(r){return null==r?H():Array.isArray(r)?R(r):"function"==typeof r?J(r):A(r)}function A(r){return v((fn=d(U,r))($))}function R(r){return v((fn=g(U,r))($))}function H(){return v((fn=y)($))}function J(r){return fn=y,K(en=r),sn=0,ln=q,on}function K(r){var n,t,e,o=[],u=[];for(n=0;q>n;++n)!(I[Z][t=_[n]]&X)^!!(e=r($[n],n))&&(e?(I[Z][t]&=Y,o.push(t)):(I[Z][t]|=X,u.push(t)));F.forEach(function(r){r(X,Z,o,u)}),N()}function L(r){var n,t=[],e=ln;if(o){for(;--e>=sn&&r>0;)I.zero(n=_[e])&&(t.push(S[n]),--r);return t}for(;--e>=sn&&r>0;)I.zero(n=_[e])&&(t.push(S[n]),--r);return t}function P(r){for(var n,t=[],e=sn;ln>e&&r>0;)I.zero(n=_[e])&&(t.push(S[n]),--r),e++;return t}function Q(r){function t(n,t,e,u){function f(){++L===K&&(y=G(y,J<<=1),C=G(C,J),K=M(J))}var s,l,h,v,p,d,g=j,y=O(L,K),x=R,k=V,m=H,z=L,w=0,E=0;for(T&&(x=m=b),T&&(k=m=b),j=Array(L),L=0,C=z>1?D(C,q):O(q,K),z&&(h=(l=g[0]).key);u>E&&!((v=r(n[E]))>=v);)++E;for(;u>E;){for(l&&v>=h?(p=l,d=h,y[w]=L,(l=g[++w])&&(h=l.key)):(p={key:v,value:m()},d=v),j[L]=p;!(v>d||(C[s=t[E]+e]=L,p.value=x(p.value,S[s],!0),I.zeroExcept(s,Z,Y)||(p.value=k(p.value,S[s],!1)),++E>=u));)v=r(n[E]);f()}for(;z>w;)j[y[w]=L]=g[w++],f();if(L>w)for(w=0;e>w;++w)C[w]=y[C[w]];s=F.indexOf(P),L>1?(P=o,Q=a):(!L&&W&&(L=1,j=[{key:null,value:m()}]),1===L?(P=i,Q=c):(P=b,Q=b),C=null),F[s]=P}function e(){if(L>1){for(var r=L,n=j,t=O(r,r),e=0,u=0;q>e;++e)I.zero(e)||(t[C[u]=C[e]]=1,++u);for(j=[],L=0,e=0;r>e;++e)t[e]&&(t[e]=L++,j.push(n[e]));if(L>1)for(var e=0;u>e;++e)C[e]=t[C[e]];else C=null;F[F.indexOf(P)]=L>1?(Q=a,P=o):1===L?(Q=c,P=i):Q=P=b}else if(1===L){if(W)return;for(var e=0;q>e;++e)if(!I.zero(e))return;j=[],L=0,F[F.indexOf(P)]=P=Q=b}}function o(r,n,t,e,o){if(!(r===X&&n===Z||T)){var u,i,f,a;for(u=0,f=t.length;f>u;++u)I.zeroExcept(i=t[u],Z,Y)&&(a=j[C[i]],a.value=R(a.value,S[i]));for(u=0,f=e.length;f>u;++u)I.onlyExcept(i=e[u],Z,Y,n,r)&&(a=j[C[i]],a.value=V(a.value,S[i],o))}}function i(r,n,t,e,o){if(!(r===X&&n===Z||T)){var u,i,f,a=j[0];for(u=0,f=t.length;f>u;++u)I.zeroExcept(i=t[u],Z,Y)&&(a.value=R(a.value,S[i]));for(u=0,f=e.length;f>u;++u)I.onlyExcept(i=e[u],Z,Y,n,r)&&(a.value=V(a.value,S[i],o))}}function a(){var r,n;for(r=0;L>r;++r)j[r].value=H();for(r=0;q>r;++r)n=j[C[r]],n.value=R(n.value,S[r],!0);for(r=0;q>r;++r)I.zeroExcept(r,Z,Y)||(n=j[C[r]],n.value=V(n.value,S[r],!1))}function c(){var r,n=j[0];for(n.value=H(),r=0;q>r;++r)n.value=R(n.value,S[r],!0);for(r=0;q>r;++r)I.zeroExcept(r,Z,Y)||(n.value=V(n.value,S[r],!1))}function s(){return T&&(Q(),T=!1),j}function l(r){var n=U(s(),0,j.length,r);return N.sort(n,0,n.length)}function h(r,n,t){return R=r,V=n,H=t,T=!0,A}function v(){return h(m,z,x)}function p(r){return h(w(r),E(r),x)}function d(r){function n(n){return r(n.value)}return U=f(n),N=u(n),A}function g(){return d(n)}function y(){return L}function k(){var r=F.indexOf(P);return r>=0&&F.splice(r,1),r=an.indexOf(t),r>=0&&an.splice(r,1),r=B.indexOf(e),r>=0&&B.splice(r,1),A}var A={top:l,all:s,reduce:h,reduceCount:v,reduceSum:p,order:d,orderNatural:g,size:y,dispose:k,remove:k};cn.push(A);var j,C,U,N,R,V,H,J=8,K=M(J),L=0,P=b,Q=b,T=!0,W=r===b;return arguments.length<1&&(r=n),F.push(P),an.push(t),B.push(e),t($,_,0,q),v().orderNatural()}function T(){var r=Q(b),n=r.all;return delete r.all,delete r.top,delete r.order,delete r.orderNatural,delete r.size,r.value=function(){return n()[0].value},r}function W(){cn.forEach(function(r){r.dispose()});var r=V.indexOf(a);return r>=0&&V.splice(r,1),r=V.indexOf(s),r>=0&&V.splice(r,1),r=B.indexOf(h),r>=0&&B.splice(r,1),I.masks[Z]&=Y,H()}var X,Y,Z,$,_,rn,nn,tn,en,on={filter:p,filterExact:A,filterRange:R,filterFunction:J,filterAll:H,top:L,bottom:P,group:Q,groupAll:T,dispose:W,remove:W},un=c(function(r){return rn[r]}),fn=y,an=[],cn=[],sn=0,ln=0;V.unshift(a),V.push(s),B.push(h);var hn=I.add();return Z=hn.offset,X=hn.one,Y=~X,a(S,0,q),s(S,0,q),on}function s(){function r(r,n){var t;if(!v)for(t=n;q>t;++t)a=c(a,S[t],!0),I.zero(t)||(a=s(a,S[t],!1))}function n(r,n,t,e,o){var u,i,f;if(!v){for(u=0,f=t.length;f>u;++u)I.zero(i=t[u])&&(a=c(a,S[i],o));for(u=0,f=e.length;f>u;++u)I.only(i=e[u],n,r)&&(a=s(a,S[i],o))}}function t(){var r;for(a=l(),r=0;q>r;++r)a=c(a,S[r],!0),I.zero(r)||(a=s(a,S[r],!1))}function e(r,n,t){return c=r,s=n,l=t,v=!0,h}function o(){return e(m,z,x)}function u(r){return e(w(r),E(r),x)}function i(){return v&&(t(),v=!1),a}function f(){var t=F.indexOf(n);return t>=0&&F.splice(t),t=V.indexOf(r),t>=0&&V.splice(t),h}var a,c,s,l,h={reduce:e,reduceCount:o,reduceSum:u,value:i,dispose:f,remove:f},v=!0;return F.push(n),V.push(r),r(S,0,q),o()}function h(){return q}function v(){return S}function A(r){return"function"!=typeof r?(console.warn("onChange callback parameter must be a function!"),void 0):(H.push(r),function(){H.splice(H.indexOf(r),1)})}function N(){for(var r=0;r<H.length;r++)H[r]()}var I,R={add:r,remove:o,dimension:a,groupAll:s,size:h,all:v,onChange:A},S=[],q=0,F=[],V=[],B=[],H=[];return I=new p(0),arguments.length?r(arguments[0]):R}function O(r,n){return(257>n?F:65537>n?V:B)(r)}function C(r){for(var n=O(r,r),t=-1;++t<r;)n[t]=t;return n}function M(r){return 8===r?256:16===r?65536:4294967296}A.version="2.0.0-alpha.03",A.permute=e;var U=A.bisect=o(n);U.by=o;var N=A.heap=u(n);N.by=u;var I=A.heapselect=f(n);I.by=f;var R=A.insertionsort=a(n);R.by=a;var S=A.quicksort=c(n);S.by=c;var q=32,F=s,V=s,B=s,D=h,G=v;"undefined"!=typeof Uint8Array&&(F=function(r){return new Uint8Array(r)},V=function(r){return new Uint16Array(r)},B=function(r){return new Uint32Array(r)},D=function(r,n){if(r.length>=n)return r;var t=new r.constructor(n);return t.set(r),t},G=function(r,n){var t;switch(n){case 16:t=V(r.length);break;case 32:t=B(r.length);break;default:throw Error("invalid array width!")}return t.set(r),t}),p.prototype.lengthen=function(r){var n,t;for(n=0,t=this.subarrays;t>n;++n)this[n]=D(this[n],r);this.length=r},p.prototype.add=function(){var r,n,t,e,o;for(e=0,o=this.subarrays;o>e;++e)if(r=this.masks[e],n=this.width-32*e,t=~r&-~r,!(n>=32)||t)return 32>n&&t&1<<n&&(this[e]=G(this[e],n<<=1),this.width=32*e+n),this.masks[e]|=t,{offset:e,one:t};return this[this.subarrays]=F(this.length),this.masks[this.subarrays]=1,this.width+=8,{offset:this.subarrays++,one:1}},p.prototype.copy=function(r,n){var t,e;for(t=0,e=this.subarrays;e>t;++t)this[t][r]=this[t][n]},p.prototype.truncate=function(r){var n,t;for(n=0,t=this.subarrays;t>n;++n){for(var e=this.length-1;e>=r;e--)this[n][e]=0;this[n].length=r}this.length=r},p.prototype.zero=function(r){var n,t;for(n=0,t=this.subarrays;t>n;++n)if(this[n][r])return!1;return!0},p.prototype.zeroExcept=function(r,n,t){var e,o;for(e=0,o=this.subarrays;o>e;++e)if(e===n?this[e][r]&t:this[e][r])return!1;return!0},p.prototype.only=function(r,n,t){var e,o;for(e=0,o=this.subarrays;o>e;++e)if(this[e][r]!=(e===n?t:0))return!1;return!0},p.prototype.onlyExcept=function(r,n,t,e,o){var u,i,f;for(i=0,f=this.subarrays;f>i;++i)if(u=this[i][r],i===n&&(u&=t),u!=(i===e?o:0))return!1;return!0},r.crossfilter=A}("undefined"!=typeof exports&&exports||this);